(this.webpackJsonptrybetunes=this.webpackJsonptrybetunes||[]).push([[0],{30:function(t,e,n){},41:function(t,e,n){"use strict";n.r(e);var a=n(1),r=n.n(a),c=n(23),i=n.n(c),s=(n(30),n(4)),o=n(5),u=n(7),l=n(6),d=n(14),j=n(15),b=n(2),h=n.n(b),m=n(3),p=n(13),f=n(8),O="user",v=function(t){return localStorage.setItem(O,JSON.stringify(t))},g=function(t){return function(e){setTimeout((function(){e(t)}),1500)}},x=function(){return new Promise((function(t){var e=JSON.parse(localStorage.getItem(O));null===e&&(e={}),g(e)(t)}))},k=function(t){return new Promise((function(e){v(Object(j.a)(Object(j.a)({},{name:"",email:"",image:"",description:""}),t)),g("OK")(e)}))},S=function(t){return new Promise((function(e){v(Object(j.a)({},t)),g("OK")(e)}))},w=n(0),y=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(){return Object(s.a)(this,n),e.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(w.jsx)("div",{"data-testid":"page-loading",children:Object(w.jsx)("p",{children:"Carregando..."})})}}]),n}(r.a.Component),C=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(t){var a;return Object(s.a)(this,n),(a=e.call(this,t)).onButtonClick=Object(m.a)(h.a.mark((function t(){var e,n;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.setState({loading:!0}),e=a.state.name,n=a.props.history,a.setState({button:!0,name:""}),t.next=6,k({name:"".concat(e)});case 6:n.push("/search");case 7:case"end":return t.stop()}}),t)}))),a.onInputChange=function(t){var e=t.target,n=e.name,r=e.value;a.setState(Object(p.a)({},n,r),(function(){r.length>=3&&a.setState({button:!1})}))},a.state={name:"",button:!0,loading:!1},a}return Object(o.a)(n,[{key:"render",value:function(){var t=this.state,e=t.name,n=t.button,a=t.loading;return Object(w.jsx)("div",{"data-testid":"page-login",children:a?Object(w.jsx)(y,{}):Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("p",{children:"Page Login:"}),Object(w.jsxs)("form",{children:[Object(w.jsx)("label",{htmlFor:"page-login",children:Object(w.jsx)("input",{type:"text",id:"login","data-testid":"login-name-input",placeholder:"Write your name here",name:"name",value:e,onChange:this.onInputChange})}),Object(w.jsx)("button",{type:"submit","data-testid":"login-submit-button",onClick:this.onButtonClick,disabled:n,children:"Entrar"})]})]})})}}]),n}(r.a.Component),N=n(18),I=n(20),F=function(){var t=Object(m.a)(h.a.mark((function t(e){var n,a,r,c,i,s;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=encodeURI(e).replaceAll("%20","+"),a="https://itunes.apple.com/search?entity=album&term=".concat(n,"&attribute=allArtistTerm"),t.next=4,fetch(a);case 4:return r=t.sent,t.next=7,r.json();case 7:return c=t.sent,i=c.results,s=i.map((function(t){return{artistId:t.artistId,artistName:t.artistName,collectionId:t.collectionId,collectionName:t.collectionName,collectionPrice:t.collectionPrice,artworkUrl100:t.artworkUrl100,releaseDate:t.releaseDate,trackCount:t.trackCount}})),t.abrupt("return",s);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),U=F,M=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(t){var a;return Object(s.a)(this,n),(a=e.call(this,t)).state={userName:"",loading:!1},a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.getUserName()}},{key:"componentWillUnmount",value:function(){this.getUserName()}},{key:"getUserName",value:function(){var t=Object(m.a)(h.a.mark((function t(){var e=this;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.setState({loading:!0},Object(m.a)(h.a.mark((function t(){var n,a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x();case 2:n=t.sent,a=n.name,e.setState({userName:a,loading:!1});case 5:case"end":return t.stop()}}),t)}))));case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this.state,e=t.userName,n=t.loading;return Object(w.jsxs)("header",{"data-testid":"header-component",children:[n?Object(w.jsx)(y,{}):Object(w.jsx)("h1",{"data-testid":"header-user-name",children:"User: ".concat(e,"!")}),Object(w.jsxs)("nav",{children:[Object(w.jsx)(d.b,{to:"/search","data-testid":"link-to-search",children:"   -- Search  --  "}),Object(w.jsx)(d.b,{to:"/favorites","data-testid":"link-to-favorites",children:" Favorites-- "}),Object(w.jsx)(d.b,{to:"/profile","data-testid":"link-to-profile",children:" --Profile-- "})]})]})}}]),n}(r.a.Component),A=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(){var t;return Object(s.a)(this,n),(t=e.call(this)).searchAlbum=function(){var e=t.state.inputSearch;t.setState({results:e,inputSearch:"",loading:!0},Object(m.a)(h.a.mark((function n(){var a;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,U(e);case 2:a=n.sent,t.setState({albums:Object(N.a)(a),loading:!1,button:!0});case 4:case"end":return n.stop()}}),n)}))))},t.onInputChange=function(e){var n=e.target,a=n.name,r=n.value;t.setState(Object(p.a)({},a,r),(function(){r.length>=2&&t.setState({button:!1})}))},t.state={button:!0,inputSearch:"",loading:!1,results:"",albums:[]},t}return Object(o.a)(n,[{key:"render",value:function(){var t=this.state,e=t.inputSearch,n=t.button,a=t.albums,r=t.loading,c=t.results;return Object(w.jsxs)("div",{"data-testid":"page-search",children:[Object(w.jsx)(M,{}),r?Object(w.jsx)(y,{}):Object(w.jsxs)("div",{children:[a.length>0?Object(w.jsx)("p",{children:"Resultado de \xe1lbuns de: ".concat(c)}):Object(w.jsx)("p",{children:"Nenhum \xe1lbum foi encontrado"}),Object(w.jsxs)("form",{children:[Object(w.jsx)("input",{type:"text",id:"search","data-testid":"search-artist-input",placeholder:"Digite o nome da banda ou artista a ser pesquisada.",name:"inputSearch",value:e,onChange:this.onInputChange}),Object(w.jsx)("button",{type:"submit","data-testid":"search-artist-button",onClick:this.searchAlbum,disabled:n,children:"Pesquisar"}),a.map((function(t){return Object(w.jsx)("div",{children:Object(w.jsxs)("div",{children:[Object(w.jsx)("h3",{children:t.artistName}),Object(w.jsx)("p",{children:t.collectionName}),Object(w.jsx)("img",{src:t.artworkUrl100,alt:t.collectionName}),Object(w.jsx)(I.Link,{to:"/album/".concat(t.collectionId),"data-testid":"link-to-album-".concat(t.collectionId),children:Object(w.jsx)("p",{children:"link para o album:"})})]})},t.collectionId)}))]})]})]})}}]),n}(r.a.Component),P=function(){var t=Object(m.a)(h.a.mark((function t(e){var n,a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://itunes.apple.com/lookup?id=".concat(e,"&entity=song"));case 2:return n=t.sent,t.next=5,n.json();case 5:return a=t.sent,t.abrupt("return",a.results);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),R=P,D="favorite_songs";JSON.parse(localStorage.getItem(D))||localStorage.setItem(D,JSON.stringify([]));var J=function(){return JSON.parse(localStorage.getItem(D))},L=function(t){return localStorage.setItem(D,JSON.stringify(t))},B=function(t){return function(e){setTimeout((function(){e(t)}),500)}},E=function(){return new Promise((function(t){var e=J();B(e)(t)}))},K=function(t){return new Promise((function(e){if(t){var n=J();L([].concat(Object(N.a)(n),[t]))}B("OK")(e)}))},W=function(t){return new Promise((function(e){var n=J();L(n.filter((function(e){return e.trackId!==t.trackId}))),B("OK")(e)}))},T=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(t){var a;return Object(s.a)(this,n),(a=e.call(this,t)).handleFavoriteMusics=Object(m.a)(h.a.mark((function t(){var e,n,r;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.setState({loading:!0}),t.next=3,E();case 3:e=t.sent,a.setState({loading:!1,favorites:e}),n=a.state.favorites,r=a.props.album.trackName,n.find((function(t){return t.trackName===r}))&&a.setState({check:!0});case 9:case"end":return t.stop()}}),t)}))),a.addFavoriteSong=Object(m.a)(h.a.mark((function t(){var e;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.setState({loading:!0}),e=a.props.album,t.next=4,K(e);case 4:a.setState({loading:!1,check:!0});case 5:case"end":return t.stop()}}),t)}))),a.removeFavoriteMusic=Object(m.a)(h.a.mark((function t(){var e,n,r;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=a.props,n=e.album,r=e.removeMusic,a.setState({loading:!0}),t.next=4,W(n);case 4:"function"===typeof r&&r(n),a.setState({loading:!1,check:!1});case 6:case"end":return t.stop()}}),t)}))),a.handleChange=function(t){t.target.checked?a.addFavoriteSong():a.removeFavoriteMusic()},a.state={loading:!1,check:!1,favorites:[]},a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.handleFavoriteMusics()}},{key:"render",value:function(){var t=this,e=this.props.album,n=e.trackName,a=e.previewUrl,r=e.trackId,c=this.state,i=c.loading,s=c.check;return Object(w.jsx)("div",{children:i?Object(w.jsx)(y,{}):Object(w.jsxs)("section",{children:[Object(w.jsx)("h4",{children:n}),Object(w.jsx)("audio",{"data-testid":"audio-component",src:a,controls:!0,children:Object(w.jsx)("track",{kind:"captions"})}),Object(w.jsxs)("label",{htmlFor:"favorites",children:["Favorita",Object(w.jsx)("input",{id:"favorites",type:"checkbox",checked:s,"data-testid":"checkbox-music-".concat(r),onChange:function(e){t.handleChange(e)}})]})]})})}}]),n}(a.Component),q=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(){var t;return Object(s.a)(this,n),(t=e.call(this)).getMusicFromApi=function(){var e=t.props.match.params.id;t.setState({loading:!0},Object(m.a)(h.a.mark((function n(){var a;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,R(e);case 2:a=n.sent,t.setState({albums:Object(N.a)(a),loading:!1});case 4:case"end":return n.stop()}}),n)}))))},t.state={albums:[],loading:!1},t}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.getMusicFromApi()}},{key:"componentWillUnmount",value:function(){this.getMusicFromApi()}},{key:"render",value:function(){var t=this.state,e=t.loading,n=t.albums;return Object(w.jsxs)("div",{"data-testid":"page-album",children:[Object(w.jsx)(M,{}),0===n.length||e?Object(w.jsx)(y,{}):Object(w.jsxs)("section",{children:[Object(w.jsx)("p",{"data-testid":"artist-name",children:n[0].artistName}),Object(w.jsx)("p",{"data-testid":"album-name",children:n[0].collectionName}),n.map((function(t,e){return Object(w.jsx)("section",{children:void 0!==t.trackName&&Object(w.jsx)(T,{trackName:t.trackName,previewUrl:t.previewUrl,trackId:t.trackId,album:t})},e)}))]})]})}}]),n}(a.Component),H=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(t){var a;return Object(s.a)(this,n),(a=e.call(this,t)).removeMusic=function(t){a.setState({loading:!0});var e=a.state.favorites.filter((function(e){return e!==t}));a.setState({favorites:e,loading:!1})},a.handleFavoriteMusics=Object(m.a)(h.a.mark((function t(){var e;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.setState({loading:!0}),t.next=3,E();case 3:e=t.sent,console.log(e),a.setState({loading:!1,favorites:e});case 6:case"end":return t.stop()}}),t)}))),a.state={loading:!1,favorites:[]},a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.handleFavoriteMusics()}},{key:"render",value:function(){var t=this,e=this.state,n=e.loading,a=e.favorites;return console.log(a),Object(w.jsxs)("div",{"data-testid":"page-favorites",children:[Object(w.jsx)(M,{}),n?Object(w.jsx)(y,{}):Object(w.jsx)("section",{children:a.map((function(e,n){return Object(w.jsx)("section",{children:void 0!==e.trackName&&Object(w.jsx)(T,{trackName:e.trackName,previewUrl:e.previewUrl,trackId:e.trackId,album:e,removeMusic:t.removeMusic})},n)}))})]})}}]),n}(r.a.Component),_=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(){var t;return Object(s.a)(this,n),(t=e.call(this)).getUserFromApi=function(){t.setState({loading:!0},Object(m.a)(h.a.mark((function e(){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x();case 2:n=e.sent,t.setState({loading:!1,userInfo:n});case 4:case"end":return e.stop()}}),e)}))))},t.state={userInfo:{},loading:!1},t}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.getUserFromApi()}},{key:"render",value:function(){var t=this.state,e=t.loading,n=t.userInfo;return Object(w.jsxs)("div",{"data-testid":"page-profile",children:[Object(w.jsx)(M,{}),e?Object(w.jsx)(y,{}):Object(w.jsxs)("section",{children:[Object(w.jsx)("p",{children:n.name}),Object(w.jsx)("p",{children:n.email}),Object(w.jsx)("p",{children:n.description}),Object(w.jsx)("img",{"data-testid":"profile-image",src:n.image,alt:n.image}),Object(w.jsx)(d.b,{to:"/profile/edit",children:"Editar perfil"})]})]})}}]),n}(a.Component),z=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(){var t;return Object(s.a)(this,n),(t=e.call(this)).getUsersFromApi=function(){t.setState({loading:!0},Object(m.a)(h.a.mark((function e(){var n,a,r,c,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x();case 2:n=e.sent,a=n.name,r=n.email,c=n.description,i=n.image,t.setState({loading:!1,name:a,email:r,description:c,image:i}),t.check();case 6:case"end":return e.stop()}}),e)}))))},t.userFormChange=function(e){var n=e.target;t.setState(Object(p.a)({},n.name,n.value),(function(){t.check()}))},t.check=function(){var e=t.state,n=e.name,a=e.email,r=e.description,c=e.image;""!==n&&""!==a&&""!==r&&""!==c?t.setState({check:!1}):t.setState({check:!0})},t.updateUser=function(){t.setState({loading:!0},Object(m.a)(h.a.mark((function e(){var n,a,r,c,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.state,a=n.name,r=n.email,c=n.image,i=n.description,e.next=3,S({name:a,email:r,image:c,description:i});case 3:t.setState({loading:!1});case 4:case"end":return e.stop()}}),e)})))),t.setState({redirect:!0})},t.state={loading:!1,name:"",email:"",description:"",image:"",check:!0,redirect:!1},t}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.getUsersFromApi()}},{key:"componentWillUnmount",value:function(){this.getUsersFromApi()}},{key:"render",value:function(){var t=this.state,e=t.loading,n=t.description,a=t.email,r=t.image,c=t.name,i=t.check,s=t.redirect;return Object(w.jsxs)("div",{"data-testid":"page-profile-edit",children:[Object(w.jsx)(M,{}),e?Object(w.jsx)(y,{}):Object(w.jsxs)("section",{children:[Object(w.jsxs)("form",{children:[Object(w.jsx)("input",{"data-testid":"edit-input-name",type:"text",value:c,name:"name",placeholder:"Name",onChange:this.userFormChange}),Object(w.jsx)("input",{type:"email","data-testid":"edit-input-email",value:a,name:"email",placeholder:"Email",onChange:this.userFormChange}),Object(w.jsx)("textarea",{"data-testid":"edit-input-description",value:n,name:"description",placeholder:"About",onChange:this.userFormChange}),Object(w.jsx)("input",{"data-testid":"edit-input-image",value:r,placeholder:"User Image",name:"image",onChange:this.userFormChange}),Object(w.jsx)("button",{type:"button","data-testid":"edit-button-save",disabled:i,onClick:this.updateUser,children:"salvar"})]}),Object(w.jsx)("div",{children:s&&Object(w.jsx)(I.Redirect,{to:"/profile"})})]})]})}}]),n}(a.Component),G=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(){return Object(s.a)(this,n),e.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(w.jsx)("div",{"data-testid":"page-not-found",children:"Home"})}}]),n}(r.a.Component),Q=G,V=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(t){var a;return Object(s.a)(this,n),(a=e.call(this,t)).onLoginInputChange=function(t){var e=t.target,n="checkbox"===e.type?e.checked:e.value;a.setState(Object(p.a)({},e.name,n),(function(){a.state.inputName.length>=3?a.setState({buttonOn:!1}):a.setState({buttonOn:!0})}))},a.onLoginButtonClick=function(){var t=a.state.inputName;a.setState({loading:!0},Object(m.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k({name:t});case 2:a.setState({loading:!1,redirect:!0});case 3:case"end":return e.stop()}}),e)}))))},a.state={inputName:"",musics:[],nameArtist:"",nameAlbum:"",buttonOn:!0,loading:!1,redirect:!1},a}return Object(o.a)(n,[{key:"render",value:function(){var t=this,e=this.state,n=e.inputName,a=e.musics,r=e.nameAlbum,c=e.nameArtist,i=e.buttonOn,s=e.redirect,o=e.loading;return Object(w.jsx)("main",{children:Object(w.jsxs)(f.Switch,{children:[Object(w.jsx)(f.Route,{exact:!0,path:"/",render:function(e){return Object(w.jsx)(C,Object(j.a)(Object(j.a)({},e),{},{buttonOn:i,inputName:n,onLoginInputChange:t.onLoginInputChange,onLoginButtonClick:t.onLoginButtonClick,loading:o}))},children:s&&Object(w.jsx)(f.Redirect,{to:"/search"})}),Object(w.jsx)(f.Route,{exact:!0,path:"/search",render:function(){return Object(w.jsx)(A,{})}}),Object(w.jsx)(f.Route,{exact:!0,path:"/album/:id",render:function(t){return Object(w.jsx)(q,Object(j.a)(Object(j.a)({},t),{},{musics:a,nameAlbum:r,nameArtist:c}))}}),Object(w.jsx)(f.Route,{exact:!0,path:"/favorites",component:H}),Object(w.jsx)(f.Route,{exact:!0,path:"/profile",component:_}),Object(w.jsx)(f.Route,{exact:!0,path:"/profile/edit",component:z}),Object(w.jsx)(f.Route,{path:"*",component:Q})]})})}}]),n}(r.a.Component),X=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(){return Object(s.a)(this,n),e.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(w.jsx)("div",{children:Object(w.jsx)(d.a,{basename:"/musics-preview-routers-crud",children:Object(w.jsx)(V,{})})})}}]),n}(r.a.Component),Y=X;i.a.render(Object(w.jsx)(r.a.StrictMode,{children:Object(w.jsx)(Y,{})}),document.getElementById("root"))}},[[41,1,2]]]);
//# sourceMappingURL=main.97fcd56b.chunk.js.map