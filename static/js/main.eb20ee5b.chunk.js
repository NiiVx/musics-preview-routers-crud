(this["webpackJsonpmusics-preview-routers-crud"]=this["webpackJsonpmusics-preview-routers-crud"]||[]).push([[0],{40:function(e,t,n){},53:function(e,t,n){"use strict";n.r(t);var a,r,c,i,s,o,u=n(1),l=n.n(u),d=n(31),j=n.n(d),p=(n(40),n(5)),b=n(6),h=n(8),m=n(7),f=n(14),O=n(15),v=n(2),g=n.n(v),x=n(3),k=n(13),S=n(4),w="user",y=function(e){return localStorage.setItem(w,JSON.stringify(e))},C=function(e){return function(t){setTimeout((function(){t(e)}),1500)}},I=function(){return new Promise((function(e){var t=JSON.parse(localStorage.getItem(w));null===t&&(t={}),C(t)(e)}))},N=function(e){return new Promise((function(t){y(Object(O.a)(Object(O.a)({},{name:"",email:"",image:"",description:""}),e)),C("OK")(t)}))},F=function(e){return new Promise((function(t){y(Object(O.a)({},e)),C("OK")(t)}))},A=n(0),M=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){return Object(A.jsx)("div",{"data-testid":"page-loading",children:Object(A.jsx)("h2",{children:"Carregando..."})})}}]),n}(l.a.Component),U=n(16),P=n(17),R=P.a.div(a||(a=Object(U.a)(["\n  align-items: center;\n  display: flex;\n  flex-direction: column;\n  height: 100vh;\n  padding-top: 12%;\n"]))),D=P.a.p(r||(r=Object(U.a)(["\n  font-size: 42px;\n"]))),J=P.a.input(c||(c=Object(U.a)(["\nfont-size: 18px;\npadding: 10px;\nmargin: 10px;\nbackground: papayawhip;\nborder: none;\nborder-radius: 3px;\n::placeholder {\n  color: palevioletred;\n}\n"]))),L=P.a.button(i||(i=Object(U.a)(["\nfont-size: 18px;\npadding: 10px;\nmargin: 10px;\nbackground: papayawhip;\nborder: none;\nborder-radius: 3px;\nalign-items: center;\n"]))),B=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(p.a)(this,n),(a=t.call(this,e)).onButtonClick=Object(x.a)(g.a.mark((function e(){var t,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({loading:!0}),t=a.state.name,n=a.props.history,a.setState({button:!0,name:""}),e.next=6,N({name:"".concat(t)});case 6:n.push("/search");case 7:case"end":return e.stop()}}),e)}))),a.onInputChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(k.a)({},n,r),(function(){r.length>=3&&a.setState({button:!1})}))},a.state={name:"",button:!0,loading:!1},a}return Object(b.a)(n,[{key:"render",value:function(){var e=this.state,t=e.name,n=e.button,a=e.loading;return Object(A.jsx)(R,{"data-testid":"page-login",children:a?Object(A.jsx)(M,{}):Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(D,{className:"login-logo",children:"Page Login:"}),Object(A.jsx)("div",{children:Object(A.jsxs)("form",{children:[Object(A.jsx)(J,{type:"text",id:"login","data-testid":"login-name-input",placeholder:"Write your name here",name:"name",value:t,onChange:this.onInputChange}),Object(A.jsx)(L,{type:"submit","data-testid":"login-submit-button",onClick:this.onButtonClick,disabled:n,children:"Entrar"})]})})]})})}}]),n}(l.a.Component),E=n(20),z=n(25),K=function(){var e=Object(x.a)(g.a.mark((function e(t){var n,a,r,c,i,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=encodeURI(t).replaceAll("%20","+"),a="https://itunes.apple.com/search?entity=album&term=".concat(n,"&attribute=allArtistTerm"),e.next=4,fetch(a);case 4:return r=e.sent,e.next=7,r.json();case 7:return c=e.sent,i=c.results,s=i.map((function(e){return{artistId:e.artistId,artistName:e.artistName,collectionId:e.collectionId,collectionName:e.collectionName,collectionPrice:e.collectionPrice,artworkUrl100:e.artworkUrl100,releaseDate:e.releaseDate,trackCount:e.trackCount}})),e.abrupt("return",s);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=K,W=n(29),q=P.a.header(s||(s=Object(U.a)(["\n  justify-content: space-between;\n  display: flex;\n  padding: 10px;\n  nav {\n    display: flex;\n    justify-content: space-around;\n    width: 40%;\n  }\n"]))),H=P.a.h1(o||(o=Object(U.a)(["\n  font-size: 42px;\n\n"])));var _=function(){var e=Object(u.useState)(""),t=Object(W.a)(e,2),n=t[0],a=t[1],r=Object(u.useState)(!1),c=Object(W.a)(r,2),i=c[0],s=c[1];function o(){return l.apply(this,arguments)}function l(){return(l=Object(x.a)(g.a.mark((function e(){var t,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(!0),e.next=3,I();case 3:t=e.sent,n=t.name,a(n),s(!1);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(u.useEffect)((function(){return o(),function(){o()}}),[]),Object(A.jsxs)(q,{"data-testid":"header-component",children:[i?Object(A.jsx)(M,{}):Object(A.jsx)(H,{"data-testid":"header-user-name",children:"".concat(n)}),Object(A.jsxs)("nav",{children:[Object(A.jsx)(f.b,{to:"/search","data-testid":"link-to-search",children:"Search"}),Object(A.jsx)(f.b,{to:"/favorites","data-testid":"link-to-favorites",children:"Favorites"}),Object(A.jsx)(f.b,{to:"/profile","data-testid":"link-to-profile",children:"Profile"})]})]})},G=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(p.a)(this,n),(e=t.call(this)).searchAlbum=function(){var t=e.state.inputSearch;e.setState({results:t,inputSearch:"",loading:!0},Object(x.a)(g.a.mark((function n(){var a;return g.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,T(t);case 2:a=n.sent,e.setState({albums:Object(E.a)(a),loading:!1,button:!0});case 4:case"end":return n.stop()}}),n)}))))},e.onInputChange=function(t){var n=t.target,a=n.name,r=n.value;e.setState(Object(k.a)({},a,r),(function(){r.length>=2&&e.setState({button:!1})}))},e.state={button:!0,inputSearch:"",loading:!1,results:"",albums:[]},e}return Object(b.a)(n,[{key:"render",value:function(){var e=this.state,t=e.inputSearch,n=e.button,a=e.albums,r=e.loading,c=e.results;return Object(A.jsxs)("div",{"data-testid":"page-search",className:"login-page-container",children:[Object(A.jsx)(_,{}),r?Object(A.jsx)(M,{}):Object(A.jsxs)(R,{children:[a.length>0&&Object(A.jsx)("p",{children:"Resultado de \xe1lbuns de: ".concat(c)}),Object(A.jsxs)("form",{children:[Object(A.jsx)("input",{type:"text",id:"search","data-testid":"search-artist-input",placeholder:"Digite o nome da banda ou artista a ser pesquisada.",name:"inputSearch",value:t,onChange:this.onInputChange}),Object(A.jsx)("button",{type:"submit","data-testid":"search-artist-button",onClick:this.searchAlbum,disabled:n,children:"Pesquisar"}),a.map((function(e){return Object(A.jsx)("div",{children:Object(A.jsxs)("div",{children:[Object(A.jsx)("h3",{children:e.artistName}),Object(A.jsx)("p",{children:e.collectionName}),Object(A.jsx)("img",{src:e.artworkUrl100,alt:e.collectionName}),Object(A.jsx)(z.Link,{to:"/album/".concat(e.collectionId),"data-testid":"link-to-album-".concat(e.collectionId),children:Object(A.jsx)("p",{children:"link para o album:"})})]})},e.collectionId)}))]})]})]})}}]),n}(l.a.Component),Q=function(){var e=Object(x.a)(g.a.mark((function e(t){var n,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://itunes.apple.com/lookup?id=".concat(t,"&entity=song"));case 2:return n=e.sent,e.next=5,n.json();case 5:return a=e.sent,e.abrupt("return",a.results);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=Q,X="favorite_songs";JSON.parse(localStorage.getItem(X))||localStorage.setItem(X,JSON.stringify([]));var Y=function(){return JSON.parse(localStorage.getItem(X))},Z=function(e){return localStorage.setItem(X,JSON.stringify(e))},$=function(e){return function(t){setTimeout((function(){t(e)}),500)}},ee=function(){return new Promise((function(e){var t=Y();$(t)(e)}))},te=function(e){return new Promise((function(t){if(e){var n=Y();Z([].concat(Object(E.a)(n),[e]))}$("OK")(t)}))},ne=function(e){return new Promise((function(t){var n=Y();Z(n.filter((function(t){return t.trackId!==e.trackId}))),$("OK")(t)}))},ae=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(p.a)(this,n),(a=t.call(this,e)).handleFavoriteMusics=Object(x.a)(g.a.mark((function e(){var t,n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({loading:!0}),e.next=3,ee();case 3:t=e.sent,a.setState({loading:!1,favorites:t}),n=a.state.favorites,r=a.props.album.trackName,n.find((function(e){return e.trackName===r}))&&a.setState({check:!0});case 9:case"end":return e.stop()}}),e)}))),a.addFavoriteSong=Object(x.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({loading:!0}),t=a.props.album,e.next=4,te(t);case 4:a.setState({loading:!1,check:!0});case 5:case"end":return e.stop()}}),e)}))),a.removeFavoriteMusic=Object(x.a)(g.a.mark((function e(){var t,n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props,n=t.album,r=t.removeMusic,a.setState({loading:!0}),e.next=4,ne(n);case 4:"function"===typeof r&&r(n),a.setState({loading:!1,check:!1});case 6:case"end":return e.stop()}}),e)}))),a.handleChange=function(e){e.target.checked?a.addFavoriteSong():a.removeFavoriteMusic()},a.state={loading:!1,check:!1,favorites:[]},a}return Object(b.a)(n,[{key:"componentDidMount",value:function(){this.handleFavoriteMusics()}},{key:"render",value:function(){var e=this,t=this.props.album,n=t.trackName,a=t.previewUrl,r=t.trackId,c=this.state,i=c.loading,s=c.check;return Object(A.jsx)("div",{children:i?Object(A.jsx)(M,{}):Object(A.jsxs)("section",{children:[Object(A.jsx)("h4",{children:n}),Object(A.jsx)("audio",{"data-testid":"audio-component",src:a,controls:!0,children:Object(A.jsx)("track",{kind:"captions"})}),Object(A.jsxs)("label",{htmlFor:"favorites",children:["Favorita",Object(A.jsx)("input",{id:"favorites",type:"checkbox",checked:s,"data-testid":"checkbox-music-".concat(r),onChange:function(t){e.handleChange(t)}})]})]})})}}]),n}(u.Component),re=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(p.a)(this,n),(e=t.call(this)).getMusicFromApi=function(){var t=e.props.match.params.id;e.setState({loading:!0},Object(x.a)(g.a.mark((function n(){var a;return g.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,V(t);case 2:a=n.sent,e.setState({albums:Object(E.a)(a),loading:!1});case 4:case"end":return n.stop()}}),n)}))))},e.state={albums:[],loading:!1},e}return Object(b.a)(n,[{key:"componentDidMount",value:function(){this.getMusicFromApi()}},{key:"componentWillUnmount",value:function(){this.getMusicFromApi()}},{key:"render",value:function(){var e=this.state,t=e.loading,n=e.albums;return Object(A.jsxs)("div",{"data-testid":"page-album",children:[Object(A.jsx)(_,{}),0===n.length||t?Object(A.jsx)(M,{}):Object(A.jsxs)("section",{children:[Object(A.jsx)("p",{"data-testid":"artist-name",children:n[0].artistName}),Object(A.jsx)("p",{"data-testid":"album-name",children:n[0].collectionName}),n.map((function(e,t){return Object(A.jsx)("section",{children:void 0!==e.trackName&&Object(A.jsx)(ae,{trackName:e.trackName,previewUrl:e.previewUrl,trackId:e.trackId,album:e})},t)}))]})]})}}]),n}(u.Component),ce=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(p.a)(this,n),(a=t.call(this,e)).removeMusic=function(e){a.setState({loading:!0});var t=a.state.favorites.filter((function(t){return t!==e}));a.setState({favorites:t,loading:!1})},a.handleFavoriteMusics=Object(x.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({loading:!0}),e.next=3,ee();case 3:t=e.sent,console.log(t),a.setState({loading:!1,favorites:t});case 6:case"end":return e.stop()}}),e)}))),a.state={loading:!1,favorites:[]},a}return Object(b.a)(n,[{key:"componentDidMount",value:function(){this.handleFavoriteMusics()}},{key:"render",value:function(){var e=this,t=this.state,n=t.loading,a=t.favorites;return console.log(a),Object(A.jsxs)("div",{"data-testid":"page-favorites",children:[Object(A.jsx)(_,{}),n?Object(A.jsx)(M,{}):Object(A.jsx)("section",{children:a.map((function(t,n){return Object(A.jsx)("section",{children:void 0!==t.trackName&&Object(A.jsx)(ae,{trackName:t.trackName,previewUrl:t.previewUrl,trackId:t.trackId,album:t,removeMusic:e.removeMusic})},n)}))})]})}}]),n}(l.a.Component),ie=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(p.a)(this,n),(e=t.call(this)).getUserFromApi=function(){e.setState({loading:!0},Object(x.a)(g.a.mark((function t(){var n;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,I();case 2:n=t.sent,e.setState({loading:!1,userInfo:n});case 4:case"end":return t.stop()}}),t)}))))},e.state={userInfo:{},loading:!1},e}return Object(b.a)(n,[{key:"componentDidMount",value:function(){this.getUserFromApi()}},{key:"render",value:function(){var e=this.state,t=e.loading,n=e.userInfo;return Object(A.jsxs)("div",{"data-testid":"page-profile",children:[Object(A.jsx)(_,{}),t?Object(A.jsx)(M,{}):Object(A.jsxs)("section",{children:[Object(A.jsx)("p",{children:n.name}),Object(A.jsx)("p",{children:n.email}),Object(A.jsx)("p",{children:n.description}),Object(A.jsx)("img",{"data-testid":"profile-image",src:n.image,alt:n.image}),Object(A.jsx)(f.b,{to:"/profile/edit",children:"Editar perfil"})]})]})}}]),n}(u.Component),se=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(p.a)(this,n),(e=t.call(this)).getUsersFromApi=function(){e.setState({loading:!0},Object(x.a)(g.a.mark((function t(){var n,a,r,c,i;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,I();case 2:n=t.sent,a=n.name,r=n.email,c=n.description,i=n.image,e.setState({loading:!1,name:a,email:r,description:c,image:i}),e.check();case 6:case"end":return t.stop()}}),t)}))))},e.userFormChange=function(t){var n=t.target;e.setState(Object(k.a)({},n.name,n.value),(function(){e.check()}))},e.check=function(){var t=e.state,n=t.name,a=t.email,r=t.description,c=t.image;""!==n&&""!==a&&""!==r&&""!==c?e.setState({check:!1}):e.setState({check:!0})},e.updateUser=function(){e.setState({loading:!0},Object(x.a)(g.a.mark((function t(){var n,a,r,c,i;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state,a=n.name,r=n.email,c=n.image,i=n.description,t.next=3,F({name:a,email:r,image:c,description:i});case 3:e.setState({loading:!1});case 4:case"end":return t.stop()}}),t)})))),e.setState({redirect:!0})},e.state={loading:!1,name:"",email:"",description:"",image:"",check:!0,redirect:!1},e}return Object(b.a)(n,[{key:"componentDidMount",value:function(){this.getUsersFromApi()}},{key:"componentWillUnmount",value:function(){this.getUsersFromApi()}},{key:"render",value:function(){var e=this.state,t=e.loading,n=e.description,a=e.email,r=e.image,c=e.name,i=e.check,s=e.redirect;return Object(A.jsxs)("div",{"data-testid":"page-profile-edit",children:[Object(A.jsx)(_,{}),t?Object(A.jsx)(M,{}):Object(A.jsxs)("section",{children:[Object(A.jsxs)("form",{children:[Object(A.jsx)("input",{"data-testid":"edit-input-name",type:"text",value:c,name:"name",placeholder:"Name",onChange:this.userFormChange}),Object(A.jsx)("input",{type:"email","data-testid":"edit-input-email",value:a,name:"email",placeholder:"Email",onChange:this.userFormChange}),Object(A.jsx)("textarea",{"data-testid":"edit-input-description",value:n,name:"description",placeholder:"About",onChange:this.userFormChange}),Object(A.jsx)("input",{"data-testid":"edit-input-image",value:r,placeholder:"User Image",name:"image",onChange:this.userFormChange}),Object(A.jsx)("button",{type:"button","data-testid":"edit-button-save",disabled:i,onClick:this.updateUser,children:"salvar"})]}),Object(A.jsx)("div",{children:s&&Object(A.jsx)(z.Redirect,{to:"/profile"})})]})]})}}]),n}(u.Component),oe=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){return Object(A.jsx)("div",{"data-testid":"page-not-found",children:"Home"})}}]),n}(l.a.Component),ue=oe,le=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(p.a)(this,n),(a=t.call(this,e)).onLoginInputChange=function(e){var t=e.target,n="checkbox"===t.type?t.checked:t.value;a.setState(Object(k.a)({},t.name,n),(function(){a.state.inputName.length>=3?a.setState({buttonOn:!1}):a.setState({buttonOn:!0})}))},a.onLoginButtonClick=function(){var e=a.state.inputName;a.setState({loading:!0},Object(x.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N({name:e});case 2:a.setState({loading:!1,redirect:!0});case 3:case"end":return t.stop()}}),t)}))))},a.state={inputName:"",musics:[],nameArtist:"",nameAlbum:"",buttonOn:!0,loading:!1,redirect:!1},a}return Object(b.a)(n,[{key:"render",value:function(){var e=this,t=this.state,n=t.inputName,a=t.musics,r=t.nameAlbum,c=t.nameArtist,i=t.buttonOn,s=t.redirect,o=t.loading;return Object(A.jsx)("main",{children:Object(A.jsxs)(S.Switch,{children:[Object(A.jsx)(S.Route,{exact:!0,path:"/",render:function(t){return Object(A.jsx)(B,Object(O.a)(Object(O.a)({},t),{},{buttonOn:i,inputName:n,onLoginInputChange:e.onLoginInputChange,onLoginButtonClick:e.onLoginButtonClick,loading:o}))},children:s&&Object(A.jsx)(S.Redirect,{to:"/search"})}),Object(A.jsx)(S.Route,{exact:!0,path:"/search",render:function(){return Object(A.jsx)(G,{})}}),Object(A.jsx)(S.Route,{exact:!0,path:"/album/:id",render:function(e){return Object(A.jsx)(re,Object(O.a)(Object(O.a)({},e),{},{musics:a,nameAlbum:r,nameArtist:c}))}}),Object(A.jsx)(S.Route,{exact:!0,path:"/favorites",component:ce}),Object(A.jsx)(S.Route,{exact:!0,path:"/profile",component:ie}),Object(A.jsx)(S.Route,{exact:!0,path:"/profile/edit",component:se}),Object(A.jsx)(S.Route,{path:"*",component:ue})]})})}}]),n}(l.a.Component),de=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){return Object(A.jsx)("div",{children:Object(A.jsx)(f.a,{basename:"/musics-preview-routers-crud",children:Object(A.jsx)(le,{})})})}}]),n}(l.a.Component),je=de;j.a.render(Object(A.jsx)(l.a.StrictMode,{children:Object(A.jsx)(je,{})}),document.getElementById("root"))}},[[53,1,2]]]);
//# sourceMappingURL=main.eb20ee5b.chunk.js.map